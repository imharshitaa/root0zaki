# Pentesting Playbook

> A professional, repeatable penetration testing playbook you can display in your portfolio. Use this to communicate methodology, deliverables, and how you conduct safe, legal testing for freelance clients.

---

## About this document

This file is a concise, client-facing pentest playbook that describes the full lifecycle of an engagement: scoping and rules of engagement, technical methodology (with example commands and scripts), evidence collection and reporting, remediation guidance, and contact / engagement options.

Use this in your portfolio to show prospective clients that you follow a structured, legal, and high-quality approach.

---

## Summary / Elevator pitch

I provide comprehensive penetration testing services (external, internal, web application, API, wireless, and basic social engineering) for small and medium organisations and startups. I focus on actionable findings, clear remediation, and measurable risk reduction.

**Quick highlights:**
- Real-world attack paths and proof-of-concept (PoC) where safe.
- Prioritised remediation recommendations.
- Clear deliverables and follow-ups (retest, remediation verification).

---

## Services offered

- External network penetration testing  
- Internal network (internal network access provided or on-site) testing  
- Web application security testing (OWASP Top 10 + business logic)  
- API security testing (REST/GraphQL)  
- Mobile app (basic static + dynamic) testing  
- Cloud configuration review (AWS / Azure / GCP - non-privileged)  
- Social engineering (phishing or vishing) — by agreement  
- Red team-lite (scenarios, ad-hoc, with defined goals)

---

## Engagement model (typical)

1. **Discovery & Scoping** — confirm assets, goals, rules of engagement, and timeline.  
2. **Rules of Engagement (RoE) / Authorization** — signed permission, allowed IPs, blackout windows.  
3. **Reconnaissance** — passive then active discovery.  
4. **Vulnerability discovery & exploitation** — controlled exploitation for evidence.  
5. **Post-exploitation & pivoting** — if permitted, to demonstrate impact.  
6. **Reporting** — executive summary, technical findings, PoC, and prioritized remediation.  
7. **Retest & Verification** — optional, after fixes.

---

## Legal & Ethics (always include in portfolio)

- Testing is performed **only** after a signed engagement letter and explicit written authorization that specifies the scope, timeboxes, and allowed activities.  
- No destructive or data-wiping activities unless explicitly allowed and coordinated.  
- Client data confidentiality is respected. Evidence is stored securely and shared only with authorised contacts.

---

## Rules of Engagement (sample checklist)

- ✅ Signed authorization received (email / contract)  
- ✅ IP addresses / hostnames and asset list provided  
- ✅ Blackout windows / business hours provided (if required)  
- ✅ Out-of-scope hosts and networks specified  
- ✅ Emergency contact and incident escalation path provided  
- ✅ Agreed method of proof (masked screenshots, redacted PoC where needed)

---

## Methodology

Below is a condensed, repeatable methodology. For each phase I include objectives, sample tools, and quick example commands.

### Phase 0 — Planning & Recon

**Goal:** Understand scope, business context, and gather footprint.

**Passive recon techniques:** OSINT, WHOIS, certificate transparency, public repos, social media.

**Tools / example commands:**
```bash
# passive: domain info
whois example.com

# certificate transparency — check subdomains (visit crt.sh)
# example URL: https://crt.sh/?q=%.example.com

# search for leaks in public repos (example using GitHub search or local grep)
# (do not run destructive scans against public infrastructure without permission)
```

**Active recon:** DNS enumeration, subdomain enumeration, port discovery.
```bash
# subdomain brute force (amass)
amass enum -d example.com -o amass_subs.txt

# fast subdomain discovery (subfinder)
subfinder -d example.com -o subfinder_subs.txt

# port scan (nmap)
nmap -sS -p- --min-rate 1000 -T4 -oA nmap_allports 10.0.0.1

# HTTP/HTTPS site discovery (ffuf)
ffuf -u https://sub.example.com/FUZZ -w wordlist.txt -mc 200,301,302 -o ffuf_results.json
```

---

### Phase 1 — Scanning & Enumeration

**Goal:** Identify services, versions, and likely vulnerabilities.

**Tools / example commands:**
```bash
# service & version discovery
nmap -sC -sV -p 22,80,443,3306 -oA nmap_services 10.0.0.1

# web application fingerprinting
nikto -h https://sub.example.com -output nikto.txt

# directories and virtual hosts (gobuster)
gobuster dir -u https://sub.example.com -w /usr/share/wordlists/dirb/common.txt -t 40 -o gobuster_dirs.txt

# API discovery (manual + Burp repeater/inspector)
# use Burp Suite to crawl, intercept, and fuzz inputs
```

---

### Phase 2 — Vulnerability Analysis

**Goal:** Map findings to exploitability and impact.

- Run targeted vulnerability scanners where appropriate (Nessus, OpenVAS) *only if allowed*.  
- Prioritise issues that lead to authentication bypass, data exfiltration, RCE, or privilege escalation.

```bash
# example SQL injection quick test (use safely in scope)
python3 -c "import requests; print(requests.get('https://app.example.com/item?id=1').text[:200])"

# run SQLMap (only if allowed)
sqlmap -u "https://app.example.com/item?id=1" --batch --dbs
```

---

### Phase 3 — Exploitation / Proof of Concept

**Goal:** Safely demonstrate impact by producing PoC evidence, without causing harm.

**Principles:**
- Non-destructive PoC.  
- Minimize system load and risk of service disruption.

**Example:**
```bash
# Example: exploit an exposed Redis instance (unsafe to run publicly without permission)
# connect to redis
redis-cli -h 10.0.0.5
# Check keys
keys *
```

> **Note:** Never run destructive PoC on production systems unless explicitly authorised. In portfolio samples, describe the PoC and include redacted screenshots instead of raw payloads if needed.

---

### Phase 4 — Post-exploitation (if in-scope)

**Goal:** Demonstrate realistic impact: data access, lateral movement, persistence.

**Example tasks:**
- Harvest credentials from memory or config files  
- Dump local user database and look for privileged accounts  
- Attempt privilege escalation

**Privilege escalation example (Linux):**
```bash
# Enumerate for SUID binaries
find / -perm -4000 -type f 2>/dev/null

# Check for sudo rights
sudo -l
```

**Windows enumeration:**
```powershell
# list local admins
net localgroup Administrators

# find interesting scheduled tasks
schtasks /query /fo LIST /v
```

---

### Phase 5 — Cleanup

**Goal:** Remove any artifacts created during testing and restore systems to original state.

- Remove created users, SSH keys, web shells, or persistent services.  
- Revoke any temporary credentials used.  
- Confirm system integrity with the client.

---

## Evidence collection & handling

- Keep detailed logs: commands used, timestamps, and outputs (redact sensitive data as required).  
- Screenshots should include timestamps and the minimal data needed to demonstrate impact.  
- Evidence stored encrypted and delivered only to authorised recipients.

---

## Reporting — structure & templates

**Deliverables typically included:**
- Executive Summary (non-technical)  
- Scope & RoE  
- Methodology  
- Findings (prioritised)  
- PoC and evidence (redacted where necessary)  
- Risk rating matrix and remediation guidance  
- Appendix (tool output, raw logs if authorised)

**Sample finding entry (markdown-ready):**
```markdown
### Finding #1: SQL Injection at `/item` (High)
**Affected:** https://app.example.com/item
**Description:** Unsanitized `id` parameter allows SQL injection.
**Proof of Concept:**
```
`GET /item?id=1' OR '1'='1` (shows all records)
```
**Impact:** Full disclosure of database contents, potential data exfiltration.
**Recommendation:** Use parameterised queries (prepared statements), implement input validation, and enforce least privilege on DB accounts.
**Status:** Open
```

---

## Risk rating / severity guide (suggested)

- **Critical:** Immediate action required — leads to complete system compromise or data breach.  
- **High:** Exploitable vulnerabilities that enable significant impact.  
- **Medium:** Vulnerabilities that require additional conditions or user interaction.  
- **Low:** Information disclosure, weak security controls with limited impact.  
- **Informational:** Observations, configuration notes.

---

## Example tools & scripts (non-exhaustive)

- Recon: `amass`, `subfinder`, `crt.sh`, `theHarvester`  
- Scanning: `nmap`, `masscan`, `nikto`  
- Web testing: `Burp Suite`, `ffuf`, `gobuster`, `sqlmap`, `wpscan`  
- Post-exploitation: `Metasploit` (with care), `mimikatz` (Windows - use only in strict engagements), `Responder`  
- Reporting: `Dradis`, `Serpico`, or custom Markdown/PDF templates

**Small helper script (safe example): list live hosts in CIDR (using Python)**
```python
#!/usr/bin/env python3
import ipaddress, socket

cidr = '192.168.1.0/28'
for ip in ipaddress.IPv4Network(cidr):
    s = socket.socket()
    s.settimeout(0.5)
    try:
        s.connect((str(ip), 80))
        print(str(ip) + ' - port 80 open')
    except Exception:
        pass
    finally:
        s.close()
```

---

## Sample engagement letter (short)

> **Engagement Letter**  
>  
> This authorization grants [Tester Name] permission to perform penetration testing against the defined assets listed in the attached scope for the period [start date] to [end date]. The client acknowledges potential service disruption risks and has provided emergency contact details. Tester agrees to act ethically and confidentially.

(Include signature lines for client and tester.)

---

## Sample communication plan

- **Kickoff call** — align expectation, confirm scope (Day 0)  
- **Status update** — optional mid-engagement check-in (if requested)  
- **Draft report** — delivered to technical contact (end of test)  
- **Executive report** — delivered to decision-makers (end of test)  
- **Remediation call** — optional technical walkthrough (scheduled)  
- **Retest** — after remediation (by agreement)

---

## Portfolio-ready disclosure / example (how you present a sample finding)

> **Example finding shown in my portfolio (redacted):**  
> - *Type:* SQL Injection (High)  
> - *Asset:* `https://example-app` (redacted)  
> - *Impact:* Data disclosure of user table  
> - *PoC:* Redacted query and screenshot showing filtered dataset  
> - *Remediation:* Parameterised queries, strict DB roles

This allows showcasing skill without disclosing client-sensitive data.

---

## How I work with clients (contact template you can copy)

**If you're interested in a pentest for your project:**

1. Share the target asset list (domains / IPs / brief description).  
2. Indicate preferred test window and any blackout periods.  
3. Tell me the contact for emergency escalation and the authorised signatory.

**Typical pricing models I offer:**
- Fixed-price for scoped web-app tests.  
- Time-and-materials for larger network engagements.  
- Subscription / retainer options for recurring security checks.

**Contact me:**  
- Email: `yourname@example.com` (replace with your contact)  
- LinkedIn: `https://linkedin.com/in/yourprofile` (optional)  
- Scheduling: `https://calendly.com/yourname` (optional)

*(Replace placeholders above with your real contact details before publishing.)*

---

## Design notes for your portfolio page

- Show 1–2 redacted sample findings (high impact) with short explanations.  
- Provide a one-paragraph method summary and a visual timeline of phases.  
- Show deliverables (Executive Summary, Technical Report, PoC, Retest) as icons/badges.  
- Include a clear CTA: _"Request a security review — contact me at <email>"_.

---

## Final checklist before accepting work

- [ ] Signed authorization  
- [ ] Scope and blackout windows defined  
- [ ] Emergency contact provided  
- [ ] Agreed deliverables and timeline  
- [ ] Payment/PO agreed (if required)

---

## Footer — short bio you can copy into portfolio

> **About me** — I'm a penetration tester and security researcher focused on web applications and infrastructure for startups and small organisations. I help identify real-world attack paths and provide practical, prioritized remediation advice. Available for freelance engagements. Contact: `yourname@example.com`.

---

*End of playbook.*
